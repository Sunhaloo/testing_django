<!doctype html>
<html lang="en">
<style>
  header {
    background-color: white;
  }
</style>

<head>
  <!-- tell Django to load the files inside `static` folder -->
  {% load static %}

  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- add a global title -->
  <title>{% block title %}NomNom{% endblock %}</title>

  <!-- add our custom 'inter' font -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link
    href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@300..700&family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap"
    href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@300..700&family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap"
    rel="stylesheet">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <!-- add our custom 'poppins' font -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link
    href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap"
    rel="stylesheet">

  <!-- link the main style sheet found in `static` folder -->
  <link href="{% static 'landing/style.css' %}" rel="stylesheet" />
  <link href="{% static 'about_us/style.css' %}" rel="stylesheet" />
  <link href="{% static 'login/style.css' %}" rel="stylesheet" />
  <link href="{% static 'contact/style.css' %}" rel="stylesheet" />
  <link href="{% static 'style.css' %}" rel="stylesheet" />
  {% block extra_css %}{% endblock %}

  <!-- Global JavaScript functions -->
  <script>
    // Global showLoginPrompt function - reusable across all pages
    function showLoginPrompt(customMessage = 'You must login to add items to cart.') {
      // Create overlay
      const overlay = document.createElement('div');
      overlay.className = 'login-overlay';
      overlay.style.cssText = `
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        z-index: 9999;
        backdrop-filter: blur(3px);
        animation: fadeIn 0.3s ease;
      `;

      const notification = document.createElement('div');
      notification.className = 'login-notification';
      notification.innerHTML = `
        <div class="login-notification-content">
          <i class="fas fa-lock"></i>
          <h3>Login Required</h3>
          <p>${customMessage}</p>
          <a href="/login/" class="login-btn">Click here to login</a>
          <button class="close-popup-btn">&times;</button>
        </div>
      `;

      // Add styles
      notification.style.cssText = `
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: white;
        padding: 40px;
        border-radius: 16px;
        box-shadow: 0 10px 40px rgba(0,0,0,0.3);
        z-index: 10000;
        text-align: center;
        min-width: 400px;
        animation: scaleIn 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      `;

      const content = notification.querySelector('.login-notification-content');
      content.style.cssText = `
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 15px;
        position: relative;
      `;

      const icon = notification.querySelector('i');
      icon.style.cssText = `
        color: #8D6E63;
        font-size: 48px;
        margin-bottom: 10px;
        background: #F5F5F5;
        width: 80px;
        height: 80px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 50%;
      `;

      const title = notification.querySelector('h3');
      title.style.cssText = `
        margin: 0;
        color: #3E2723;
        font-size: 24px;
        font-weight: 700;
      `;

      const paragraph = notification.querySelector('p');
      paragraph.style.cssText = `
        margin: 0;
        color: #666;
        font-size: 16px;
        margin-bottom: 10px;
      `;

      const link = notification.querySelector('.login-btn');
      link.style.cssText = `
        background: #8D6E63;
        color: white;
        padding: 12px 30px;
        border-radius: 30px;
        text-decoration: none;
        font-weight: 600;
        font-size: 16px;
        transition: all 0.3s ease;
        display: inline-block;
        margin-top: 10px;
      `;

      // Hover effect for button
      link.onmouseover = () => {
        link.style.background = '#6D4C41';
        link.style.transform = 'translateY(-2px)';
        link.style.boxShadow = '0 5px 15px rgba(141, 110, 99, 0.4)';
      };
      link.onmouseout = () => {
        link.style.background = '#8D6E63';
        link.style.transform = 'translateY(0)';
        link.style.boxShadow = 'none';
      };

      const closeBtn = notification.querySelector('.close-popup-btn');
      closeBtn.style.cssText = `
        position: absolute;
        top: -30px;
        right: -30px;
        background: none;
        border: none;
        font-size: 24px;
        color: #999;
        cursor: pointer;
        padding: 5px;
      `;

      function removePopup() {
        overlay.style.opacity = '0';
        notification.style.opacity = '0';
        notification.style.transform = 'translate(-50%, -50%) scale(0.8)';
        overlay.style.transition = 'opacity 0.3s ease';
        notification.style.transition = 'all 0.3s ease';

        setTimeout(() => {
          overlay.remove();
          notification.remove();
          const styleEl = document.getElementById('popup-animations');
          if (styleEl) styleEl.remove();
        }, 300);
      }

      closeBtn.onclick = removePopup;
      overlay.onclick = (e) => {
        if (e.target === overlay) removePopup();
      };

      document.body.appendChild(overlay);
      document.body.appendChild(notification);

      // Add animation styles if not present
      if (!document.getElementById('popup-animations')) {
        const style = document.createElement('style');
        style.id = 'popup-animations';
        style.textContent = `
          @keyframes scaleIn {
            from { opacity: 0; transform: translate(-50%, -50%) scale(0.8); }
            to { opacity: 1; transform: translate(-50%, -50%) scale(1); }
          }
          @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
          }
        `;
        document.head.appendChild(style);
      }
    }

    // Global helper to update cart count
    function updateCartCount(count) {
      const cartCountElement = document.getElementById('cart-count');
      if (cartCountElement) {
        cartCountElement.textContent = count;

        // Hide badge if count is 0
        if (count === 0) {
          cartCountElement.classList.add('hidden');
        } else {
          cartCountElement.classList.remove('hidden');
          // Add bump animation
          cartCountElement.classList.add('bump');
          setTimeout(() => {
            cartCountElement.classList.remove('bump');
          }, 300);
        }
      }
    }

    // Wrapper function for cart icon click
    function showCartLoginPrompt(event) {
      event.preventDefault();
      showLoginPrompt('You must login to access cart.');
    }
  </script>
</head>

<body class="{% block body_class %}{% endblock %}">
  <!-- include the navigation bar at the top of `base.html` file -->
  {% include 'navbar.html' %}

  {% block content %}
  <!-- applications overridden contents goes here -->
  {% endblock %}

  <!-- include the footer at the bottom of `base.html` file -->
  {% include 'footer.html' %}

  <!-- Initialize cart count -->
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      const cartCountElement = document.getElementById('cart-count');
      if (cartCountElement) {
        const count = {{ cart_item_count|default: 0
      }
    };
    cartCountElement.textContent = count;
    if (count === 0) {
      cartCountElement.classList.add('hidden');
    } else {
      cartCountElement.classList.remove('hidden');
    }
      }
    });
  </script>
</body>

</html>