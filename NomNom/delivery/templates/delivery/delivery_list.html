{% extends 'base.html' %}
{% load static %}

{% block title %}Deliveries{% endblock %}

{% block extra_css %}
    <link rel="stylesheet" href="{% static 'delivery/delivery.css' %}">
{% endblock %}

{% block content %}
<section class="page-section">
  <div class="container">
    <h2 class="section-title"><i class="fas fa-shipping-fast"></i> My Deliveries</h2>

    {% if deliveries %}
      <table class="styled-table">
        <thead>
          <tr>
            <th>Delivery ID</th>
            <th>Order ID</th>
            <th>Address</th>
            <th>Status</th>
            <th>Date</th>
            <th>Action</th>
          </tr>
        </thead>
        <tbody>
          {% for d in deliveries %}
          <tr>
            <td>#{{ d.id }}</td>
            <td>#{{ d.order.id }}</td>
            <td>{{ d.address }}</td>
            <td>
              {% if d.status == 'Pending' %}
                <span class="badge badge-warning">{{ d.status }}</span>
              {% elif d.status == 'Done' %}
                <span class="badge badge-success">{{ d.status }}</span>
              {% else %}
                <span class="badge badge-danger">{{ d.status }}</span>
              {% endif %}
            </td>
            <td>{{ d.date|date:"d M Y" }}</td>
            <td>
              <a href="{% url 'delivery:delivery_detail' d.id %}" class="btn btn-primary btn-sm">View</a>
              {% if user.is_staff %}
                <a href="{% url 'delivery:update_delivery_status' d.id %}" class="btn btn-secondary btn-sm">Update</a>
              {% endif %}
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    {% else %}
      <p class="empty-msg">No deliveries found.</p>
    {% endif %}
  </div>
</section>
{% endblock %}